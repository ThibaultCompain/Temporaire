def generer_requete_hive(nom_schema, nom_table, liste_colonnes):
    """
    Génère une requête SQL Hive pour extraire des exemples de valeurs pour chaque colonne.

    Args:
        nom_schema (str): Nom du schéma Hive.
        nom_table (str): Nom de la table Hive.
        liste_colonnes (list): Liste des noms de colonnes (obtenue via DESCRIBE).
    Returns:
        str: Requête SQL Hive complète.
    """
    requete = ""
    for i, colonne in enumerate(liste_colonnes):
        requete += f"""
        SELECT
          '{colonne}' AS column_name,
          (
            SELECT ARRAY_AGG(DISTINCT CAST({colonne} AS STRING) LIMIT 3)
            FROM {nom_schema}.{nom_table}
            WHERE CAST({colonne} AS STRING) IS NOT NULL
            LIMIT 100
          ) AS exemples_valeurs
        """
        if i < len(liste_colonnes) - 1:
            requete += "UNION ALL\n"

    return requete

# Exemple d'utilisation :
# Remplacez les valeurs ci-dessous par les vôtres
nom_schema = "votre_schema"
nom_table = "votre_table"
liste_colonnes = [
    "colonne1",
    "colonne2",
    "colonne3"
    # Ajoutez ici les autres colonnes obtenues via DESCRIBE
]

requete_hive = generer_requete_hive(nom_schema, nom_table, liste_colonnes)
print(requete_hive)
